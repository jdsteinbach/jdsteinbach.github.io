<!DOCTYPE html>
<html lang="en" xmlns="https://www.w3.org/1999/xhtml" xmlns:og="https://ogp.me/ns#" xmlns:fb="https://www.facebook.com/2008/fbml">

<head itemscope itemtype="http://schema.org/WebSite">
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title itemprop="name">The Holy Grail of CSS Animation • James Steinbach</title>
  <meta name="version" content="1.1" />
  <meta name="description" content="Front-end architect. Speaker & writer. Sass, CSS animation, RWD & WP." />
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="The Holy Grail of CSS Animation • James Steinbach" />
  <meta property="og:description" content="Front-end architect. Speaker & writer. Sass, CSS animation, RWD & WP." />
  <meta property="og:url" content="https://jdsteinbach.com/css/holy-grail-css-animation/" />
  <meta property="og:site_name" content="James Steinbach" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:description" content="Front-end architect. Speaker & writer. Sass, CSS animation, RWD & WP." />
  <meta name="twitter:title" content="The Holy Grail of CSS Animation • James Steinbach" />
  <meta name="twitter:url" content="https://jdsteinbach.com/css/holy-grail-css-animation/" />
  <meta name="twitter:site" content="@jdsteinbach" />
  <meta name="twitter:creator" content="@jdsteinbach" />

  <meta name="test-pagination" content="">

  <link rel="stylesheet" href="/styles/main.css" />
  <link rel="canonical" href="https://jdsteinbach.com/css/holy-grail-css-animation/" itemprop="url" />
  <link rel="alternate" type="application/rss+xml" title="James Steinbach" href="https://jdsteinbach.com/feed.xml" />

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="manifest" href="/site.webmanifest" />
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#e65100" />
  <meta name="msapplication-TileColor" content="#e65100" />
  <meta name="theme-color" content="#e65100" />
</head>

<body class="site">
  <header class="site-header" role="banner">
  <div class="l-wrapper l-wrapper--wide">
    <a class="site-header__title" href="/">James Steinbach</a>
    <nav class="header-nav" id="header-nav"><a class="header-nav__link" href="/css/" data-order="10">CSS</a><a class="header-nav__link" href="/sass/" data-order="20">Sass</a><a class="header-nav__link" href="/wordpress/" data-order="30">WP</a><a class="header-nav__link" href="/talks/" data-order="35">Talks</a><a class="header-nav__link" href="/about/" data-order="40">About</a><a class="header-nav__link" href="/contact/" data-order="50">Contact</a></nav>
  </div>
</header>

  <main class="site-main" id="main" role="main">

  <article class="post l-page" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="hero l-hero">
      
    <svg viewBox="0 0 64 64" preserveAspectRatio="xMidYMid slice" alt="" role="presentation">
  <defs>
    <linearGradient x="0" y="0" x2="1" y2="1" spreadMethod="pad" id="lg">
      <stop offset="0" stop-color="#131313" stop-opacity="0" />
      <stop offset=".5" stop-color="#131313" stop-opacity=".05" />
      <stop offset="1" stop-color="#131313" stop-opacity=".15" />
    </linearGradient>
  </defs>
  <g transform="translate(-14 -14)">
    <rect width="28" height="28" fill="url(#lg)" y="0" x="0" />
    <rect width="28" height="28" fill="url(#lg)" y="16" x="0" />
    <rect width="28" height="28" fill="url(#lg)" y="32" x="0" />
    <rect width="28" height="28" fill="url(#lg)" y="48" x="0" />
    <rect width="28" height="28" fill="url(#lg)" y="64" x="0" />

    <rect width="28" height="28" fill="url(#lg)" y="0" x="16" />
    <rect width="28" height="28" fill="url(#lg)" y="16" x="16" />
    <rect width="28" height="28" fill="url(#lg)" y="32" x="16" />
    <rect width="28" height="28" fill="url(#lg)" y="48" x="16" />
    <rect width="28" height="28" fill="url(#lg)" y="64" x="16" />

    <rect width="28" height="28" fill="url(#lg)" y="0" x="32" />
    <rect width="28" height="28" fill="url(#lg)" y="16" x="32" />
    <rect width="28" height="28" fill="url(#lg)" y="32" x="32" />
    <rect width="28" height="28" fill="url(#lg)" y="48" x="32" />
    <rect width="28" height="28" fill="url(#lg)" y="64" x="32" />

    <rect width="28" height="28" fill="url(#lg)" y="0" x="48" />
    <rect width="28" height="28" fill="url(#lg)" y="16" x="48" />
    <rect width="28" height="28" fill="url(#lg)" y="32" x="48" />
    <rect width="28" height="28" fill="url(#lg)" y="48" x="48" />
    <rect width="28" height="28" fill="url(#lg)" y="64" x="48" />

    <rect width="28" height="28" fill="url(#lg)" y="0" x="64" />
    <rect width="28" height="28" fill="url(#lg)" y="16" x="64" />
    <rect width="28" height="28" fill="url(#lg)" y="32" x="64" />
    <rect width="28" height="28" fill="url(#lg)" y="48" x="64" />
    <rect width="28" height="28" fill="url(#lg)" y="64" x="64" />
  </g>
</svg>


      <h1 class="hero__title" itemprop="name title headline">The Holy Grail of CSS Animation</h1>

      <p class="hero__meta">
          <time class="date" datetime=Fri Nov 14 2014 00:00:00 GMT+0000 (Coordinated Universal Time) itemprop="dateCreated pubdate datePublished">November 14, 2014</time>
          <span class="author" itemprop="author creator">James Steinbach</span>
          <span class="categories">
  <a href="/css/" class="category-link">[CSS]</a>
</span>
      </p>
    </header>

    <div class="main-content l-content has-toc" itemprop="articleBody">
      <p>If you’ve been doing front-end development for long, you may have heard of the “Holy Grail” of web layout. <a href="http://alistapart.com/article/holygrail">A List Apart</a> identified this layout as a flexible-width content column between two fixed-width sidebar columns, with all three columns occupying the same height between the header and footer rows. (Today we have Flexbox, so that problem is pretty solvable.)</p>
<img class="alignright wp-image-1379 size-medium" src="/images/holy-grail-168x300.png" alt="holy grail" width="168" height="300" />
<p>I’ve identified a “Holy Grail” of CSS animation that (to my knowledge) hasn’t been solved successfully yet. What I want to do is mimic jQuery’s <code>slideToggle()</code> (<code>slideDown()</code> / <code>slideUp()</code>) feature with pure CSS on in-page content. I’m picturing collapsible FAQs or Wikipedia’s mobile view where content is collapsed under the header (except animated, unlike Wikipedia). Here are my five requirements for this behavior:</p>
<ol>
<li>Uses CSS animation/transitions</li>
<li>Works on elements of any height</li>
<li>Maintains proper easing and timing</li>
<li>Following content fills collapsed space</li>
<li>Jank-free performance</li>
</ol>
<h2 id="uses-css-animation%2Ftransitions">Uses CSS animation/transitions <a class="anchor-link" href="#uses-css-animation%2Ftransitions" aria-hidden="true">#</a></h2>
<p>JS is fine and good, but I’m looking for a way to do with with just CSS.</p>
<h2 id="works-on-elements-of-any-height">Works on elements of any height <a class="anchor-link" href="#works-on-elements-of-any-height" aria-hidden="true">#</a></h2>
<p>This is a tricky one. Basically I’m asking CSS to transition between <code>height: 0;</code> and <code>height: auto;</code>. But it currently can’t.</p>
<p>If all my elements were a fixed height, I could easily transition betweeen <code>height: 0</code> and that height, but I want a technique that works without fixing the element’s height in advance.</p>
<h2 id="maintains-proper-easing-and-timing">Maintains proper easing and timing <a class="anchor-link" href="#maintains-proper-easing-and-timing" aria-hidden="true">#</a></h2>
<p>One method I’ve seen suggested is transitioning the <code>max-height</code> of the element from <code>0px</code> to <code>1000px</code> (or some other fixed measurement higher than any potential element height). However, this method destroys any deliberate easing function or timing. For example, look at the following code (add your own prefixes):</p>
<pre><code>.expandable {
  max-height: 0;
  transition: max-height 500ms ease-in-out;
}
.expandable[aria-expanded=&quot;true&quot;] {
  max-height: 1000px;
}
</code></pre>
<p>If an <code>.expandable</code> element is only 500px, its visible transition will finish in 250ms (not 500ms) because the transition calculates 1000px of motion over 500ms. The easing function will also be broken: the easing curve is also spread out over 1000px / 500ms: since the actual element has no motion left at 500px / 250ms, it won’t ease-out at all. Animating <code>max-height</code> would work if duration was completely irrelevant and if the easing function was <code>linear</code>. But if you’ve deliberately chosen your durations &amp; easing, this technique is out.</p>
<h2 id="following-content-fills-collapsed-space">Following content fills collapsed space <a class="anchor-link" href="#following-content-fills-collapsed-space" aria-hidden="true">#</a></h2>
<p>Another method for smoothly collapsing elements is transitioning between <code>transform: scaleY(0);</code> and <code>transform: scaleY(1);</code>. This handles timing &amp; easing nicely.</p>
<pre><code>.expandable {
  transform: scaleY(0);
  transition: transform 500ms ease-in-out;
}
.expandable[aria-expanded=&quot;true&quot;] {
  transform: scaleY(1);
}
</code></pre>
<p>However, it doesn’t truly “collapse” the element. An element scaled to 0 with the <code>transform</code> property still exists in the stacking order of the site, preventing sibling elements from “moving up” to fill the empty space. This method works fine on elements that aren’t in the stacking order to begin with (for example, absolutely positioned sub-menu dropdowns), but this technique fails for normal content elements.</p>
<h2 id="jank-free-performance">Jank-free performance <a class="anchor-link" href="#jank-free-performance" aria-hidden="true">#</a></h2>
<p>CSS transitions and animations (when used properly!) hit 60fps really nicely. [Hint: limit transitioned properties to <code>transform</code>, <code>opacity</code>, and properties that contain simple color values.] jQuery’s <code>slideToggle()</code> functions don’t run jank-free, however. Use them on an element with border-radius, box-shadow, or complex children and you’ll probably get a glitchy, stuttery animation.</p>
<h2 id="conclusion">Conclusion <a class="anchor-link" href="#conclusion" aria-hidden="true">#</a></h2>
<p>If you’ve got a CSS animation / transition solution that meets all the criteria above, please tweet at <a href="https://twitter.com/jdsteinbach">@jdsteinbach</a>!</p>
<h2 id="update!">UPDATE! <a class="anchor-link" href="#update!" aria-hidden="true">#</a></h2>
<p>This <a href="/css/snippet-animate-display-transform/">snippet for animating display and transform together</a> isn’t perfect, but the best solution I’ve found so far. Hope it helps!</p>


      <aside class="post-toc">
        <h5 class="post-toc__title">Table of Contents</h5>
        <nav class="toc"><ol><li><a href="#uses-css-animation%2Ftransitions">Uses CSS animation/transitions</a></li><li><a href="#works-on-elements-of-any-height">Works on elements of any height</a></li><li><a href="#maintains-proper-easing-and-timing">Maintains proper easing and timing</a></li><li><a href="#following-content-fills-collapsed-space">Following content fills collapsed space</a></li><li><a href="#jank-free-performance">Jank-free performance</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#update!">UPDATE!</a></li></ol></nav>
      </aside>
    </div>
  </article>
    </main><!-- main.site-main -->
  <footer class="site-footer" role="contentinfo">
  <div class="l-wrapper">
    <form class="form form--mailchimp" action="//jamessteinbach.us7.list-manage.com/subscribe/post?u=e06400c5106eb26339f4a0aea&amp;id=35bef0e04e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
  <h2 class="site-footer__title">Get New Posts &amp; Other Content in Your Inbox!</h2>

  <div class="form__fields" id="mc_embed_signup_scroll">
    <div class="form__fields-wrapper">
      <p class="form__required-message hidden"><span class="form__required-asterisk">*</span> indicates required</p>

      <div class="form__field form__field--email">
        <label class="form__label" for="mce-EMAIL">Email Address<span class="form__required-asterisk">*</span></label>
        <input class="form__input form__input--required form__input--email" type="email" name="EMAIL" id="mce-EMAIL">
      </div>

      <div class="form__field form__field--fname">
        <label class="form__label" for="mce-FNAME">First Name</label>
        <input class="form__input" type="text" name="FNAME" id="mce-FNAME">
      </div>

      <div class="form__field form__field--lname">
        <label class="form__label" for="mce-LNAME">Last Name </label>
        <input class="form__input" type="text" name="LNAME" id="mce-LNAME">
      </div>
    </div>

    <p class="form__response-message" id="mce-response"></p>

    <label style="position: absolute; left: -5000px;" aria-hidden="true">
      <input type="text" name="b_e06400c5106eb26339f4a0aea_35bef0e04e" tabindex="-1" value="">
    </label>

    <button class="form__submit button button-alt" type="submit">Subscribe</button>

    <p class="form__monkey-rewards mc-ref">Powered by <a href="https://www.mailchimp.com/monkey-rewards/?utm_source=freemium_newsletter&utm_medium=email&utm_campaign=monkey_rewards&aid=e06400c5106eb26339f4a0aea&afl=1" target="_blank" rel="noopener nofollow noreferrer" title="MailChimp - email marketing made easy and fun">MailChimp</a></p>
  </div>
</form>

  </div>
  <div class="l-wrapper">
    <div class="site-footer__column">
      <p>James Steinbach</p>
      <p><a href="mailto:jdsteinbach@gmail.com">jdsteinbach@gmail.com</a></p>
    </div>
    <div class="site-footer__column">
        <p>
          <a href="https://github.com/jdsteinbach">
            <span class="icon icon--github">
              <svg viewBox="0 0 16 16" height="16" width="16">
  <path fill="currentColor" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
</svg>

            </span>
            <span class="username">jdsteinbach</span>
          </a>
        </p>
        <p>
          <a href="https://twitter.com/jdsteinbach">
            <span class="icon icon--twitter">
              <svg viewBox="0 0 16 16" height="16" width="16">
  <path fill="currentColor" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
</svg>

            </span>
            <span class="username">jdsteinbach</span>
          </a>
        </p>
    </div>
    <div class="site-footer__column">
      <p class="text">Front-end architect. <br />Speaker & writer. <br />Sass, CSS animation, RWD & WP.</p>
    </div>
  </div>
</footer>

  <script>
  if (window.localStorage) {
    if (localStorage.getItem('theme') === 'dark') {
      document.body.classList.add('theme-dark');
    } else {
      document.body.classList.remove('theme-dark');
    }
  }
  </script>
  <script data-goatcounter="https://jds.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

  <script async src="/js/site.js"></script>
</body>
</html>

