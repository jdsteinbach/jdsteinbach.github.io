<!DOCTYPE html> <html lang="en" xmlns="https://www.w3.org/1999/xhtml" xmlns:og="https://ogp.me/ns#" xmlns:fb="https://www.facebook.com/2008/fbml"> <head itemscope itemtype="http://schema.org/WebSite"> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"> <meta name="theme-color" content="#5CACC4"> <title itemprop="name">Keeping RWD Simple & Sassy – Media Queries | James Steinbach</title> <meta name="description" content="Organizing media queries with Sass to keep responsive Sass code clean and maintainable."> <meta property="og:locale" content="en_US" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Keeping RWD Simple & Sassy – Media Queries | James Steinbach" /> <meta property="og:description" content="Organizing media queries with Sass to keep responsive Sass code clean and maintainable." /> <meta property="og:url" content="http://localhost:4000" /> <meta property="og:site_name" content="James Steinbach " /> <meta name="twitter:card" content="summary"/> <meta name="twitter:description" content="Organizing media queries with Sass to keep responsive Sass code clean and maintainable."/> <meta name="twitter:title" content="Keeping RWD Simple & Sassy – Media Queries | James Steinbach"/> <meta name="twitter:domain" content="http://localhost:4000"/> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="http://localhost:4000/sass/rwd-sass-media-queries/" itemprop="url"> <link rel="alternate" type="application/rss+xml" title="James Steinbach " href="http://localhost:4000/feed.xml" /> </head> <body> <header class="site-header" role="banner"> <div class="wrapper"> <a class="site-title" href="/">James Steinbach </a> <nav class="site-nav"> <a class="page-link" href="/css/">CSS</a> <a class="page-link" href="/sass/">Sass</a> <a class="page-link" href="/wordpress/">WP</a> <a class="page-link" href="/talks/">Talks</a> <a class="page-link" href="/about/">About</a> <a class="page-link" href="/contact/">Contact</a> </nav> </div> </header> <div class="page-content" id="main" role="main"> <div class="wrapper"> <div class="post"> <header class="post-header"> <h1 class="post-title">Keeping RWD Simple & Sassy – Media Queries</h1> <p class="post-meta"> <span class="date">Apr 8, 2016</span> <span class="author">James Steinbach</span> <span class="categories"> <a href="/sass" class="category-link">[Sass]</a> </span> </p> </header> <article class="post-content"> <p>This is the second post in a series based on my recent RWD Summit talk “Keeping RWD Simple &amp; Sassy.” It covers some useful techniques to manage media queries with Sass to keep your responsive Sass code base clean and maintainable.</p> <h2 id="media-query-variables">Media Query Variables</h2> <p>I know, we’re working with some bedrock basics: managing repeated values with variables. Assign any repeated value to a variable. The biggest improvements are: 1) you don’t have to look up that value every time you want to use it again and 2) you can change that value across the entire codebase by editing the variable just once. This is a practical way to apply the programming principle of having a “single source of truth” for these values.</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nv">$breakpoint-medium</span><span class="p">:</span> <span class="m">25em</span><span class="p">;</span>
<span class="nv">$breakpoint-large</span><span class="p">:</span>  <span class="m">50em</span><span class="p">;</span>
</code></pre></div> <p>Now if you want to write a media query in Sass, you can stick with your defined breakpoints like this:</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nc">.element</span> <span class="p">{</span>
  <span class="k">@media</span> <span class="n">screen</span> <span class="nf">and</span> <span class="p">(</span><span class="n">min-width</span><span class="o">:</span> <span class="nv">$breakpoint-medium</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>Let’s improve that a bit, shall we? Sass variables aren’t limited to simple string storage: they can also be maps (or associative arrays):</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nv">$breakpoints</span><span class="p">:</span> <span class="p">(</span>
  <span class="nb">default</span><span class="o">:</span> <span class="n">null</span><span class="o">,</span>
  <span class="nb">medium</span><span class="o">:</span> <span class="m">25em</span><span class="o">,</span>
  <span class="nb">large</span><span class="o">:</span> <span class="m">50em</span>
<span class="p">);</span>
</code></pre></div> <p>Or if you’ve put your breakpoints in a map, you’ll use <code class="highlighter-rouge">map-get()</code> to retreive the value for that breakpoint. This is the Sass equivalent of <code class="highlighter-rouge">array['key']</code> / <code class="highlighter-rouge">array.key</code> in JS or <code class="highlighter-rouge">$array['key']</code>in PHP:</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nc">.element</span> <span class="p">{</span>
  <span class="k">@media</span> <span class="n">screen</span> <span class="nf">and</span> <span class="p">(</span><span class="n">min-width</span><span class="o">:</span> <span class="nf">map-get</span><span class="p">(</span><span class="nv">$breakpoints</span><span class="o">,</span> <span class="nb">medium</span><span class="p">))</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <h3 id="media-query-mixin">Media Query Mixin</h3> <p>Now, that’s still a lot to type, so let’s create a mixin to make the whole MQ syntax fast and reusable:</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="k">@mixin</span> <span class="nf">media-query</span><span class="p">(</span><span class="nv">$label</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$min-width</span><span class="p">:</span> <span class="nf">map-get</span><span class="p">(</span><span class="nv">$breakpoints</span><span class="o">,</span> <span class="nv">$label</span><span class="p">);</span>
  <span class="k">@if</span> <span class="nv">$min-width</span> <span class="p">{</span>
    <span class="k">@media</span> <span class="n">screen</span> <span class="nf">and</span> <span class="p">(</span><span class="n">min-width</span><span class="o">:</span> <span class="nv">$min-width</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">@content</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">@else</span> <span class="p">{</span>
    <span class="k">@content</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.element</span> <span class="p">{</span>
  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">medium</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p><em>Note: That mixin will fail silently. If you pass it a key that doesn’t exist in <code class="highlighter-rouge">$breakpoints</code>, it’ll just output the <code class="highlighter-rouge">@content</code> CSS with no media query. Read <a href="http://jds.li/validsass">my article on Sass validation</a> for more information on validating input for Sass mixins &amp; functions.</em></p> <h3 id="breakpoints-vs-tweakpoints">Breakpoints vs. Tweakpoints</h3> <p>You may have seen <a href="http://jds.li/tweakpoints">Jeremy Keith’s article on “Tweakpoints” recently</a>. Tweakpoints are like breakpoints for a design, but not as “major.” You’re probably already used to having 3 or 4 major layout-changing breakpoints for a site. You’ve probably also felt the pain of having a few odd components that don’t seem to “break” nicely at your primary breakpoints. Tweakpoints are “sub-breakpoints” for individual parts of the site that need a slightly-adjusted breakpoint.</p> <p>You can handle tweakpoints a couple different ways. You could be strict and say, “They’re not as important as breakpoints, so they’ll be stored in their own map.” In that scenario, you’ll then need to either (a) write a <code class="highlighter-rouge">tweakpoint()</code> version of the breakpoint mixin, or (b) modify your breakpoint mixin so that it can handle tweakpoints too. If you like option (b), read <a href="http://jds.li/tpointsass">this tweakpoint Sass tutorial</a> for an example of how to scope tweakpoints to each Sass partial.</p> <p>The other way to handle tweakpoints is to decide, “I don’t care that they’re not as important as breakpoints. I’ll put them in the same map anyway and that’s fine.” The downside of this approach is that all the tweakpoints are available to the entire codebase, instead of being scoped to the style patterns that actually need them.</p> <p>Here’s my way to mess with the breakpoint mixin and get it to handle tweakpoints nicely.</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="k">@mixin</span> <span class="nf">media-query</span><span class="p">(</span><span class="nv">$label</span><span class="p">)</span> <span class="p">{</span>
  <span class="nv">$min-width</span><span class="p">:</span> <span class="nv">$label</span><span class="p">;</span>

  <span class="k">@if</span> <span class="nf">type-of</span><span class="p">(</span><span class="nv">$label</span><span class="p">)</span> <span class="o">=</span> <span class="n">string</span> <span class="p">{</span>
    <span class="nv">$min-width</span><span class="p">:</span> <span class="nf">map-get</span><span class="p">(</span><span class="nv">$breakpoints</span><span class="o">,</span> <span class="nv">$label</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">@if</span> <span class="nv">$min-width</span> <span class="p">{</span>
    <span class="k">@media</span> <span class="n">screen</span> <span class="nf">and</span> <span class="p">(</span><span class="n">min-width</span><span class="o">:</span> <span class="nv">$min-width</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">@content</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">@else</span> <span class="p">{</span>
    <span class="k">@content</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nv">$tweakpoint-element</span><span class="p">:</span> <span class="m">45em</span><span class="p">;</span>

<span class="nc">.element</span> <span class="p">{</span>
  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">medium</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nv">$tweakpoint-element</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">33</span><span class="mi">.33%</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <h3 id="per-partial-variables-for-breakpoints">Per-Partial Variables for Breakpoints</h3> <p>I often find myself in a situation where I’ve got a Sass partial that re-uses a breakpoint in several element. Navigation is a pretty common place for this to happen. I don’t always know up front if I’ll need to change the nav at the medium breakpoint, the large breakpoint, or a tweakpoint somewhere in between. I do know that when I figure out where to break that point, I’ll need to update the argument in 4-5 instances of the media query mixin. I handle that with a variable in that partial pointing to the breakpoint I want to test.</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="nv">$mq-nav</span><span class="p">:</span> <span class="nb">medium</span><span class="p">;</span>

<span class="nc">.site-nav</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>

  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nv">$mq-nav</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.site-nav-item</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>

  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nv">$mq-nav</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">inline-block</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.site-nav-link</span> <span class="p">{</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">1em</span> <span class="mi">.5em</span><span class="p">;</span>

  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nv">$mq-nav</span><span class="p">)</span> <span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">1em</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <p>In real life, the partial is never that simple: it’s got all kinds of other style information scattered around and it ends up 100 or more lines long. This alias variable allows me to link all the styles that should happen at a single breakpoint and edit that breakpoint easily.</p> <h3 id="nested-media-queries-vs-mq-partials">Nested Media Queries vs. MQ Partials</h3> <p>This may be an old topic that doesn’t need to be re-hashed here, but it’s RWD and Sass, so I think it deserves a slide or two.</p> <p>Should you nest all your media queries inside the selectors they modify, or have a partial per media query with all the modifications in each partial?</p> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="c1">// in _nav partial
</span>
<span class="nc">.site-nav</span> <span class="p">{</span>
  <span class="c1">// styles
</span>
  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">medium</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// medium styles
</span>  <span class="p">}</span>

  <span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">large</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// large styles
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div> <div class="language-scss highlighter-rouge"><pre class="highlight"><code><span class="c1">// in styles partial
</span>
<span class="k">@import</span> <span class="s1">'site-nav'</span><span class="p">;</span>

<span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">medium</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">@import</span> <span class="s1">'bp-medium'</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@include</span> <span class="nd">media-query</span><span class="p">(</span><span class="nb">large</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">@import</span> <span class="s1">'bp-large'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div> <p>Option 2 reminds us of the olden days when we wrote all our styles in a single CSS file, and put our media queries in order at the bottom of that file. If you remember those days, you probably remember the major frustration of that: to modify one component responsively, you had to keep scrolling between 3 positions in your 1000s of lines CSS file. There’s no reason to keep that frustration when you’re using a preprocessory.</p> <p>Nesting all your media queries in the selectors they modify allows you to (ideally) open 1 partial to find and maintain all the styles for a single component. When it comes to dev-friendly organization like we talked about before, nesting media queries is the way to go.</p> <p>The objection to that technique, however, is that it will bloat CSS output by repeating the media query syntax over and over again. However, that objection ignores an important factor: if you don’t repeat media queries, you’ll repeat your selectors.</p> <p>I ran a brief test to see how bad the “bloat” is. For the test, I generated 40 selectors (of varying length) and nested 2 media queries in each one. Then I wrote default styles &amp; 2 media queries with the 40 selectors repeated in each media query. The nested media query output was a bit larger: 11.3kb, while the separated media query output was 8.3kb - 25% smaller. (<em>Remember, this is not an entire stylesheet: it’s a simplified test to show how much weight the selectors &amp; queries themselves generate. Also, this is not a huge issue: if your total style sheet is ~150kb, it’s only a 2% change.</em>) Then I gzipped both output files. Surprisingly, the nested media query gzip was 87% smaller than the separated media query gzip.</p> <p>So first of all, the repetitious bloat warning is exaggerated: you’re going to have repetition no matter what you do. Secondly, however, you really <strong>must</strong> be gzipping your HTML/CSS/JS for users. Gzip compression finds all the repeated strings in a text file and uses an alias to shorten them. And for the record, you get better compression with 2 strings repeated 40x than with 40 strings repeated 2x. Nested media queries FTW!</p> <p><em>Note: <a href="http://jds.li/gzip">more information on gzip</a>.</em></p> </article> </div> </div> </div> <footer class="site-footer" role="contentinfo"> <div class="wrapper"> <!-- Begin MailChimp Signup Form --> <div id="mc_embed_signup"> <!-- Submit via Ajax: http://stackoverflow.com/a/16172798 --> <form action="//jamessteinbach.us7.list-manage.com/subscribe/post?u=e06400c5106eb26339f4a0aea&amp;id=35bef0e04e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate> <div id="mc_embed_signup_scroll"> <h2>Get New Posts &amp; Other Content in Your Inbox!</h2> <div class="mc-fields"> <div class="indicates-required"><span class="asterisk">*</span> indicates required</div> <div class="mc-field-group email"> <label for="mce-EMAIL">Email Address<span class="asterisk">*</span></label> <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"> </div> <div class="mc-field-group fname"> <label for="mce-FNAME">First Name</label> <input type="text" value="" name="FNAME" class="" id="mce-FNAME"> </div> <div class="mc-field-group lname"> <label for="mce-LNAME">Last Name </label> <input type="text" value="" name="LNAME" class="" id="mce-LNAME"> </div> </div> <div id="mce-responses" class="clear"> <div class="response" id="mce-error-response" style="display:none"></div> <div class="response" id="mce-success-response" style="display:none"></div> </div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_e06400c5106eb26339f4a0aea_35bef0e04e" tabindex="-1" value=""></div> <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button button-alt"> <p class="mc-ref">Powered by <a href="http://eepurl.com/AtwTT" title="MailChimp - email marketing made easy and fun">MailChimp</a></p> </div> </form> </div> <!--End mc_embed_signup--> </div> <div class="wrapper"> <div class="footer-col-wrapper"> <div class="footer-col footer-col-1"> <ul class="contact-list"> <li>James Steinbach</li> <li><a href="mailto:jdsteinbach@gmail.com">jdsteinbach@gmail.com</a></li> </ul> </div> <div class="footer-col footer-col-2"> <ul class="social-media-list"> <li> <a href="https://github.com/jdsteinbach"> <span class="icon icon--github"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/> </svg> </span> <span class="username">jdsteinbach</span> </a> </li> <li> <a href="https://twitter.com/jdsteinbach"> <span class="icon icon--twitter"> <svg viewBox="0 0 16 16"> <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809 c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/> </svg> </span> <span class="username">jdsteinbach</span> </a> </li> </ul> </div> <div class="footer-col footer-col-3"> <p class="text">Front-end architect. Speaker & writer.<br/>Sass, CSS animation, RWD &amp; WP. </p> </div> </div> </div> </footer> <script> if (window.localStorage) { if (localStorage.getItem('theme') === 'dark') { document.body.classList.add('theme-dark'); } else { document.body.classList.remove('theme-dark'); } } </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-43397146-5', 'auto'); ga('send', 'pageview'); </script> <script async src="/js/site.js"></script> </body> </html>
